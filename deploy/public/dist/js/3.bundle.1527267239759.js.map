{"version":3,"sources":["webpack:///./behaviours/ExampleClass.js","webpack:///./core/modules/refs.js","webpack:///./core/modules/resizer.js","webpack:///./core/modules/inview.js","webpack:///./core/behaviour.js"],"names":["ExampleClass","mount","_this","$el","classList","add","$events","attachAll","$screen","on","_ref2","width","height","query","log","unmount","events","click [data-link]","onClick","e","elm","preventDefault","toggle","viewport","enter","exit","routes","screens","(min-width: 1024px)","_ref3","match","(min-width: 680px)","_ref4","_core_behaviour__WEBPACK_IMPORTED_MODULE_0__","sanitizeName","name","replace","$0","$1","toUpperCase","removeValueLess","es","_ref","value","getDataAttributes","attr","test","cleanName","substr","flattenToObject","acc","key","composeProps","createRefs","node","getAttribute","_extends","attributes","gatherProps","refs","root","querySelectorAll","handle","resizer_query","item","getPropertyValue","getCurrentMediaQuery","window","getComputedStyle","document","body","last","getWindowProps","innerWidth","innerHeight","resizer_windowResizeEvent","_getWindowProps","eventBus","emit","resizer_windowResize","windowResize","isRunning","raf_default","a","bind","addEventListener","destroy","removeEventListener","cancel","windowMatch","breakpoint","matchMedia","matches","resizer_mapEventsToResize","Object","entries","map","_slicedToArray","fn","funk","once","arg","resizer_extends","modules_resizer","arguments","length","undefined","bank","forEach","off","modules_inview","options","defaults","inview_extends","rootMargin","threshold","observer","unobserve","IntersectionObserver","entry","type","isIntersecting","observe","Behaviour","this","el","_classCallCheck","registerObserverOptions","init","$observer","$eventBus","$refs","createEvents","call","updateRefs","behaviour_extends","$name","$data","behaviour_toConsumableArray"],"mappings":"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","file":"3.bundle.1527267239759.js","sourcesContent":["import Behaviour from '@/core/behaviour'\n\nexport default class ExampleClass extends Behaviour {\n\tmount = () => {\n\t\tthis.$el.classList.add('mount')\n\t\tthis.$events.attachAll()\n\t\tthis.$screen.on('window:resize', ({ width, height, query }) => {\n\t\t\tlog({ width, height, query })\n\t\t})\n\t}\n\n\tunmount = () => {\n\t\tthis.$el.classList.add('unmount')\n\t}\n\n\tevents = {\n\t\t'click [data-link]': 'onClick'\n\t}\n\n\tonClick = (e, elm) => {\n\t\te.preventDefault()\n\t\telm.classList.toggle('huzzah')\n\t}\n\n\tviewport = {\n\t\tenter: () => {\n\t\t\tlog('enter')\n\t\t},\n\n\t\texit: () => {\n\t\t\tlog('exit')\n\t\t}\n\t}\n\n\troutes = {\n\t\tenter: () => {\n\t\t\tthis.$el.classList.toggle('enter')\n\t\t},\n\t\texit: () => {\n\t\t\tthis.$el.classList.toggle('exit')\n\t\t}\n\t}\n\n\tscreens = {\n\t\t'(min-width: 1024px)': ({ match, width, height, query }) => {\n\t\t\tlog('(min-width: 1024px)', match, width, height, query)\n\t\t},\n\n\t\t'(min-width: 680px)': ({ match, width, height, query }) => {\n\t\t\tlog('(min-width: 680px)', match, width, height, query)\n\t\t}\n\t}\n}\n","// ({\n// \tplugins: 'jsdom-quokka-plugin',\n// \tjsdom: {\n// \t\thtml: `<div id=\"test\">\n//             <b data-element=\"mod1\" data-prop1-th=\"a\" data-prop2=\"b\"></b>\n//             <b data-element=\"mod2\" data-prop1-th=\"a\" data-prop2=\"b\"></b>\n//             <b data-element=\"mod3\" data-prop1-th=\"a\" data-prop2=\"b\"></b>\n//             <b data-element=\"mod4\" data-prop1-th=\"a\" data-prop2=\"b\"></b>\n//             <div id=\"wrapper\" data-group=\"gr1\">\n// \t\t\t\t\t\t\t<b class=\"fake\" data-behaviour=\"ModuleB\"></b>\n// \t\t\t\t\t\t</div>\n// \t\t\t\t\t</div>`\n// \t}\n// })\n\nimport * as R from 'ramda'\n\nconst sanitizeName = name => name.replace(/-(.)/g, ($0, $1) => $1.toUpperCase())\n\nconst removeValueLess = R.filter(({ value }) => value)\n\nconst getDataAttributes = R.filter(\n\tattr =>\n\t\t/^data-/.test(attr.name) &&\n\t\tattr.name !== 'data-element' &&\n\t\tattr.name !== 'data-behaviour'\n)\nconst cleanName = R.map(({ name, value }) => ({\n\tname: sanitizeName(name.substr(5)),\n\tvalue\n}))\n\nconst flattenToObject = R.reduce((acc, { name: key, value }) => {\n\tacc[key] = value\n\treturn acc\n}, {})\n\nexport const composeProps = R.compose(\n\tflattenToObject,\n\tcleanName,\n\tremoveValueLess,\n\tgetDataAttributes\n)\n\nconst gatherProps = node => composeProps([...node.attributes])\n\nconst createRefs = R.reduce((acc, node) => {\n\tacc[`${sanitizeName(node.getAttribute('data-element'))}`] = {\n\t\tnode: node,\n\t\t...gatherProps(node)\n\t}\n\n\treturn acc\n}, {})\n\nexport default root => createRefs([...root.querySelectorAll('*[data-element]')])\n","import eventBus from '@/core/modules/eventBus'\nimport raf from 'raf'\nimport * as R from 'ramda'\n\nlet handle\n\nconst getStyle = () => window.getComputedStyle(document.body, ':after')\nconst query = R.compose(R.replace(/'|\"/g, ''), item =>\n\titem.getPropertyValue('content')\n)\nconst getCurrentMediaQuery = R.compose(query, getStyle)\n\nlet last = getCurrentMediaQuery()\n\nconst getWindowProps = () => {\n\tconst width = window.innerWidth\n\tconst height = window.innerHeight\n\tconst query = getCurrentMediaQuery()\n\n\treturn {\n\t\twidth,\n\t\theight,\n\t\tquery\n\t}\n}\n\nconst windowResizeEvent = () => {\n\tconst { width, height, query } = getWindowProps()\n\n\teventBus.emit('window:resize', {\n\t\twidth,\n\t\theight,\n\t\tquery\n\t})\n\n\tif (query !== last) {\n\t\tlast = query\n\t\teventBus.emit('window:breakpoint', {\n\t\t\twidth,\n\t\t\theight,\n\t\t\tquery\n\t\t})\n\t}\n}\n\nconst windowResize = () => {\n\tif (windowResize.isRunning) return\n\twindowResize.isRunning = true\n\thandle = raf.bind(null, windowResizeEvent)\n\n\twindow.addEventListener('resize', handle, false)\n\n\treturn {\n\t\tdestroy() {\n\t\t\tif (!windowResize.isRunning) return\n\t\t\twindowResize.isRunning = false\n\t\t\twindow.removeEventListener('resize', handle, false)\n\t\t\thandle.cancel()\n\t\t}\n\t}\n}\nwindowResize.isRunning = false\n\nconst windowMatch = breakpoint => window.matchMedia(breakpoint).matches\n\nconst mapEventsToResize = events =>\n\tObject.entries(events).map(([breakpoint, fn]) => {\n\t\tconst once = (arg, fn) => {\n\t\t\tif (once.value === arg) return\n\t\t\tfn({ match: arg, ...getWindowProps() })\n\t\t\tonce.value = arg\n\t\t}\n\n\t\tconst test = (breakpoint, fn) => {\n\t\t\tconst state = windowMatch(breakpoint)\n\t\t\tonce(state, fn)\n\t\t}\n\n\t\tconst funk = test.bind(null, breakpoint, fn)\n\t\twindowMatch(breakpoint) && funk()\n\t\teventBus.on('window:resize', funk)\n\n\t\treturn funk\n\t})\n\nconst resizer = (events = {}) => {\n\twindowResize()\n\n\tlet bank = mapEventsToResize(events)\n\n\tconst destroy = () => {\n\t\tbank.forEach(fn => eventBus.off('window:resize', fn))\n\t\tbank = []\n\t}\n\n\treturn {\n\t\tget breakpoint() {\n\t\t\treturn getCurrentMediaQuery()\n\t\t},\n\n\t\tget width() {\n\t\t\treturn window.innerWidth\n\t\t},\n\n\t\tget height() {\n\t\t\treturn window.innerHeight\n\t\t},\n\n\t\tdestroy,\n\n\t\t...eventBus\n\t}\n}\n\nexport default resizer\n","import * as R from 'ramda'\n\nconst inview = R.curry((root, events, options) => {\n\tif (!events) return\n\n\tconst opts = options ? options : {}\n\tconst defaults = {\n\t\trootMargin: '0px',\n\t\tthreshold: 0,\n\t\t...opts\n\t}\n\n\tconst destroy = () => observer.unobserve(root)\n\n\tconst onIntersection = entry => {\n\t\tconst item = R.head(entry)\n\t\tconst { isIntersecting } = item\n\t\tconst type = isIntersecting ? 'enter' : 'exit'\n\t\tif (events[type]) {\n\t\t\tevents[type]({\n\t\t\t\t...item,\n\t\t\t\tdestroy\n\t\t\t})\n\t\t}\n\t}\n\n\tconst observer = new IntersectionObserver(onIntersection, defaults)\n\n\tobserver.observe(root)\n\n\treturn {\n\t\tdestroy\n\t}\n})\n\nexport default inview\n","import createEvents from '@/core/modules/createEvents'\nimport refs, { composeProps } from '@/core/modules/refs'\nimport eventBus from '@/core/modules/eventBus'\nimport resizer from '@/core/modules/resizer'\nimport inview from '@/core/modules/inview'\n\n/**\n * class Behaviour\n *\n */\nexport default class Behaviour {\n\tconstructor(el = document, name) {\n\t\tthis.$name = name\n\t\tthis.$el = el\n\t\tthis.$eventBus = eventBus\n\t\tthis.$data = composeProps([...this.$el.attributes]) // here lies a bug\n\t}\n\n\tregisterObserverOptions = {}\n\n\troutes = {\n\t\tenter: () => {},\n\t\texit: () => {}\n\t}\n\n\tviewport = {\n\t\tenter: () => {},\n\t\texit: () => {}\n\t}\n\n\tscreens = {}\n\n\tinit = () => {\n\t\tthis.$observer = inview(\n\t\t\tthis.$el,\n\t\t\tthis.viewport,\n\t\t\tthis.registerObserverOptions\n\t\t)\n\n\t\tthis.$eventBus.on('routes:enter', this.routes.enter)\n\t\tthis.$eventBus.on('routes:exit', this.routes.exit)\n\t\tthis.$refs = refs(this.$el)\n\t\tthis.$screen = resizer(this.screens)\n\t\tif (this.events) {\n\t\t\tthis.$events = createEvents.call(this, this.$el, this.events)\n\t\t}\n\n\t\treturn this\n\t}\n\n\tupdateRefs = () => {\n\t\tthis.$refs = { ...this.$refs, ...refs(this.$el) }\n\t}\n\n\tmount = () => {}\n\n\tunmount = () => {}\n\n\tdestroy = () => {\n\t\tthis.unmount()\n\t\tthis.$eventBus.off('routes:enter', this.routes.enter)\n\t\tthis.$eventBus.off('routes:exit', this.routes.exit)\n\t\tthis.$screen.destroy()\n\n\t\tif (this.viewport) {\n\t\t\tthis.$observer.destroy()\n\n\t\t\t// delete this.$observer\n\t\t}\n\n\t\tif (this.events) {\n\t\t\tthis.$events.destroy()\n\n\t\t\t// delete this.$events\n\t\t}\n\n\t\t// delete this.$eventBus\n\t\t// delete this.$screen\n\t}\n}\n"],"sourceRoot":""}